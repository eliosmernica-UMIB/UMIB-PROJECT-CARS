<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EM Luxury Cars - Reviews</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* Hero Section */
        .reviews-hero {
            min-height: 50vh;
            background: linear-gradient(135deg, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.7) 100%),
                        url('https://images.unsplash.com/photo-1603584173870-7f23fdae1b7a?auto=format&fit=crop&q=80&w=1920');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            padding-top: 80px;
        }
        .reviews-hero .badge-label {
            background: linear-gradient(135deg, #c9a033 0%, #e8c547 100%);
            color: #000;
            font-weight: 600;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }
        
        /* Stats Bar */
        .em-stats-bar {
            background: #111;
            padding: 40px 0;
        }
        .stat-item {
            text-align: center;
        }
        .stat-item h3 {
            color: #c9a033;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        .stat-item p {
            color: #888;
            margin: 0;
            font-size: 0.9rem;
        }
        
        /* Review Cards */
        .reviews-section {
            background: #f8f9fa;
            padding: 80px 0;
        }
        .em-review-card {
            background: #fff;
            border-radius: 20px;
            padding: 35px;
            height: 100%;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .em-review-card::before {
            content: '"';
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 8rem;
            color: #f0f0f0;
            font-family: Georgia, serif;
            line-height: 1;
        }
        .em-review-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        .em-review-card .stars {
            color: #c9a033;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }
        .em-review-card .em-review-title {
            font-weight: 700;
            font-size: 1.25rem;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        .em-review-card .em-review-text {
            color: #666;
            font-style: italic;
            line-height: 1.7;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }
        .em-review-card .reviewer {
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            z-index: 1;
        }
        .em-review-card .reviewer img {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #c9a033;
        }
        .em-review-card .reviewer-info h6 {
            font-weight: 700;
            margin-bottom: 2px;
        }
        .em-review-card .reviewer-info p {
            color: #888;
            font-size: 0.85rem;
            margin: 0;
        }
        
        /* Featured Review */
        .featured-review {
            background: linear-gradient(135deg, #111 0%, #222 100%);
            border-radius: 30px;
            padding: 50px;
            margin-bottom: 50px;
        }
        .featured-review .stars {
            color: #c9a033;
            font-size: 1.5rem;
        }
        .featured-review h3 {
            color: #fff;
            font-weight: 700;
        }
        .featured-review .em-review-text {
            color: #aaa;
            font-size: 1.2rem;
            line-height: 1.8;
        }
        .featured-review .reviewer img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #c9a033;
        }
        .featured-review .reviewer-info h5 {
            color: #fff;
            font-weight: 700;
        }
        .featured-review .reviewer-info p {
            color: #c9a033;
        }
        
        /* Submit Review Section */
        .submit-review-section {
            background: #fff;
            padding: 80px 0;
        }
        .em-review-form-card {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 40px;
        }
        .rating-stars .star {
            font-size: 2rem;
            color: #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .rating-stars .star.active,
        .rating-stars .star:hover {
            color: #c9a033;
            transform: scale(1.1);
        }
        
        /* CTA Section */
        .cta-section {
            background: linear-gradient(135deg, #c9a033 0%, #e8c547 100%);
            padding: 60px 0;
        }
    </style>
</head>
<body id="em-body">

    <!-- NAVIGATION -->
    <nav class="navbar navbar-expand-lg fixed-top em-navbar">
        <div class="container">
            <a class="navbar-brand em-brand" href="index.html">
                EM<span class="em-accent">.</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#emNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="emNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link em-nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link em-nav-link" href="about.html">About</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link em-nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
                            Shop NOW
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="inventory.html">Buy Cars</a></li>
                            <li><a class="dropdown-item" href="rent.html">Rent a Car</a></li>
                            <li><a class="dropdown-item" href="parts.html">Car Parts</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link em-nav-link" href="gallery.html">Gallery</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link em-nav-link" href="blog.html">Blog</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link em-nav-link active" href="testimonials.html">Reviews</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link em-nav-link" href="contact.html">Contact</a>
                    </li>
                    <li class="nav-item ms-lg-3">
                        <a href="checkout.html" class="btn em-btn-primary position-relative">
                            Cart
                            <span id="em-cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                0
                            </span>
                        </a>
                    </li>
                    <ul class="navbar-nav ms-lg-2" id="em-nav-auth"></ul>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="reviews-hero">
        <div class="container">
            <div class="text-center">
                <span class="badge-label mb-4 d-inline-block">CLIENT TESTIMONIALS</span>
                <h1 class="display-3 fw-bold text-white mb-4">What Our Clients Say</h1>
                <p class="lead text-white-50 mx-auto" style="max-width: 600px;">
                    Don't just take our word for it. Hear from collectors, enthusiasts, and drivers who found their dream cars with us.
                </p>
            </div>
        </div>
    </section>

    <!-- Stats Bar -->
    <section class="em-stats-bar">
        <div class="container">
            <div class="row">
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>500+</h3>
                        <p>Happy Clients</p>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>4.9</h3>
                        <p>Average Rating</p>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>100%</h3>
                        <p>Satisfaction</p>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="stat-item">
                        <h3>98%</h3>
                        <p>Repeat Clients</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Reviews Section -->
    <section class="reviews-section">
        <div class="container">
            
            <!-- Featured Review -->
            <div class="featured-review" id="featured-review-container">
                <!-- Will be populated by JS -->
            </div>
            
            <!-- Reviews Grid -->
            <div class="row g-4" id="testimonials-grid">
                <!-- Testimonials loaded dynamically -->
                <div class="col-12 text-center py-5">
                    <div class="spinner-border text-warning" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="text-muted mt-2">Loading reviews...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Submit Review Section -->
    <section class="submit-review-section" id="submit-review-section" style="display: none;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="text-center mb-5">
                        <span class="badge-label mb-3 d-inline-block">SHARE YOUR EXPERIENCE</span>
                        <h2 class="display-6 fw-bold">Write a Review</h2>
                        <p class="text-muted">We'd love to hear about your experience with EM Luxury Cars</p>
                    </div>
                    <div class="em-review-form-card">
                        <form id="reviewForm" onsubmit="submitReview(event)">
                            <div class="mb-4 text-center">
                                <label class="form-label fw-bold mb-3">Your Rating</label>
                                <div class="rating-stars">
                                    <input type="hidden" id="rating" value="5">
                                    <span class="star active" data-value="1">&#9733;</span>
                                    <span class="star active" data-value="2">&#9733;</span>
                                    <span class="star active" data-value="3">&#9733;</span>
                                    <span class="star active" data-value="4">&#9733;</span>
                                    <span class="star active" data-value="5">&#9733;</span>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label fw-bold">Review Title</label>
                                <input type="text" class="form-control form-control-lg" id="reviewTitle" required placeholder="Summarize your experience">
                            </div>
                            <div class="mb-4">
                                <label class="form-label fw-bold">Your Review</label>
                                <textarea class="form-control" id="reviewText" rows="5" required placeholder="Tell us about your experience in detail..."></textarea>
                            </div>
                            <button type="submit" class="btn em-btn-primary btn-lg w-100">
                                <i class="bi bi-send me-2"></i>Submit Review
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Login Prompt (for non-logged in users) -->
    <section class="submit-review-section" id="login-prompt-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6 text-center">
                    <i class="bi bi-chat-heart display-1 text-muted mb-4"></i>
                    <h3 class="fw-bold mb-3">Want to Share Your Experience?</h3>
                    <p class="text-muted mb-4">Sign in to your account to leave a review and help others discover the EM difference.</p>
                    <a href="login.html" class="btn em-btn-primary btn-lg px-5">
                        <i class="bi bi-box-arrow-in-right me-2"></i>Sign In to Review
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container text-center">
            <h3 class="fw-bold text-dark mb-3">Ready to Experience the Difference?</h3>
            <p class="text-dark mb-4">Browse our collection or schedule a visit to our showroom.</p>
            <a href="inventory.html" class="btn btn-dark btn-lg rounded-pill px-5">View Our Collection</a>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="em-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5 class="text-white fw-bold mb-3">EM<span class="em-accent">.</span> Luxury Cars</h5>
                    <p class="text-muted">The premier destination for automotive excellence. Buying, renting, and upgrading - we do it all with passion and precision.</p>
                    <div class="em-social-links">
                        <a href="#"><i class="bi bi-facebook"></i></a>
                        <a href="#"><i class="bi bi-instagram"></i></a>
                        <a href="#"><i class="bi bi-twitter-x"></i></a>
                        <a href="#"><i class="bi bi-youtube"></i></a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 mb-4">
                    <h6 class="text-white fw-bold mb-3">Quick Links</h6>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="inventory.html" class="text-muted">Inventory</a></li>
                        <li class="mb-2"><a href="rent.html" class="text-muted">Rentals</a></li>
                        <li class="mb-2"><a href="parts.html" class="text-muted">Parts Shop</a></li>
                        <li class="mb-2"><a href="gallery.html" class="text-muted">Gallery</a></li>
                    </ul>
                </div>
                <div class="col-lg-2 col-md-4 mb-4">
                    <h6 class="text-white fw-bold mb-3">Company</h6>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="about.html" class="text-muted">About Us</a></li>
                        <li class="mb-2"><a href="blog.html" class="text-muted">Blog</a></li>
                        <li class="mb-2"><a href="testimonials.html" class="text-muted">Reviews</a></li>
<li class="mb-2"><a href="contact.html" class="text-muted">Contact</a></li>
                        <li class="mb-2"><a href="terms-policies.html" class="text-muted">Terms & Policies</a></li>
                    </ul>
                </div>
                <div class="col-lg-4 col-md-4 mb-4">
                    <h6 class="text-white fw-bold mb-3">Contact Info</h6>
                    <ul class="list-unstyled text-muted">
                        <li class="mb-2"><i class="bi bi-geo-alt me-2"></i>123 Luxury Blvd, Beverly Hills, CA</li>
                        <li class="mb-2"><i class="bi bi-telephone me-2"></i>+1 (555) 123-4567</li>
                        <li class="mb-2"><i class="bi bi-envelope me-2"></i>info@emcars.com</li>
                        <li class="mb-2"><i class="bi bi-clock me-2"></i>Mon-Sat: 9AM - 7PM</li>
                    </ul>
                </div>
            </div>
            <div class="text-center mt-4 pt-4 border-top border-secondary">
                <p class="mb-0 text-muted small">&copy; 2026 EM Luxury Cars. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        // Default testimonials
        const defaultTestimonials = [
            {
                id: 'default-1',
                rating: 5,
                title: 'Found My Dream 250 GTO',
                text: 'Sourcing a 1962 Ferrari GTO seemed impossible until I contacted EM. Their logistics team handled everything from auction to delivery. The attention to detail and professionalism was unmatched. I\'ve purchased many cars over the years, but this experience was truly exceptional.',
                userName: 'Alexander Rossi',
                userTitle: 'Collector, New York',
                userPicture: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&q=80&w=150',
                approved: true,
                featured: true
            },
            {
                id: 'default-2',
                rating: 5,
                title: 'Best Rental Experience Ever',
                text: 'Rented the Bugatti Chiron for a weekend getaway. The booking process was seamless, the car was in pristine condition, and the team even gave me tips on the best driving routes. Will definitely be back for more!',
                userName: 'Sophia Chen',
                userTitle: 'Entrepreneur, Los Angeles',
                userPicture: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&q=80&w=150',
                approved: true
            },
            {
                id: 'default-3',
                rating: 5,
                title: 'Porsche GT3 RS Delivered Perfectly',
                text: 'I\'ve been searching for a 911 GT3 RS in Shark Blue for over a year. EM not only found one but negotiated a great price. The entire purchase process was transparent and stress-free. Highly recommended!',
                userName: 'Michael Thompson',
                userTitle: 'Business Owner, Miami',
                userPicture: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&q=80&w=150',
                approved: true
            },
            {
                id: 'default-4',
                rating: 5,
                title: 'OEM Parts Exceeded Expectations',
                text: 'Ordered authentic parts for my Lamborghini Miura restoration. Every piece was genuine, well-packaged, and arrived ahead of schedule. The parts team\'s knowledge of classic Lamborghinis is impressive.',
                userName: 'Emma Rodriguez',
                userTitle: 'Classic Car Restorer',
                userPicture: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&q=80&w=150',
                approved: true
            },
            {
                id: 'default-5',
                rating: 5,
                title: 'McLaren P1 - Worth Every Penny',
                text: 'The team at EM helped me acquire a McLaren P1 with incredibly low mileage. Their inspection report was thorough, and they even arranged shipping to my location in Dubai. First-class service all the way.',
                userName: 'Ahmed Al-Rashid',
                userTitle: 'Collector, Dubai',
                userPicture: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&q=80&w=150',
                approved: true
            },
            {
                id: 'default-6',
                rating: 5,
                title: 'Exceptional Knowledge & Service',
                text: 'As a first-time exotic car buyer, I had many questions. The EM team patiently guided me through every step, from selection to financing to delivery. They made what could have been overwhelming into an enjoyable experience.',
                userName: 'Jennifer Walsh',
                userTitle: 'Tech Executive, San Francisco',
                userPicture: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&q=80&w=150',
                approved: true
            }
        ];

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadTestimonials();
            setupRatingStars();
            checkLoginStatus();
        });

        function loadTestimonials() {
            const grid = document.getElementById('testimonials-grid');
            const featuredContainer = document.getElementById('featured-review-container');
            
            // Get approved testimonials from storage
            let testimonials = [];
            if (typeof EMAuth !== 'undefined' && typeof EMAuth.getTestimonials === 'function') {
                testimonials = EMAuth.getTestimonials(true);
            }
            
            // If no user testimonials, use defaults
            if (testimonials.length === 0) {
                testimonials = defaultTestimonials;
            }
            
            if (testimonials.length === 0) {
                grid.innerHTML = `
                    <div class="col-12 text-center py-5">
                        <i class="bi bi-chat-quote display-1 text-muted"></i>
                        <h4 class="mt-3">No Reviews Yet</h4>
                        <p class="text-muted">Be the first to share your experience!</p>
                    </div>
                `;
                featuredContainer.style.display = 'none';
                return;
            }
            
            // Get featured review
            const featuredReview = testimonials.find(r => r.featured) || testimonials[0];
            const regularReviews = testimonials.filter(r => r.id !== featuredReview.id);
            
            // Render featured review
            const featuredStars = '&#9733;'.repeat(featuredReview.rating || 5);
            featuredContainer.innerHTML = `
                <div class="row align-items-center">
                    <div class="col-lg-8">
                        <div class="stars mb-3">${featuredStars}</div>
                        <h3 class="mb-4">"${featuredReview.title}"</h3>
                        <p class="em-review-text mb-4">"${featuredReview.text}"</p>
                        <div class="reviewer d-flex align-items-center gap-3">
                            <img src="${featuredReview.userPicture || 'https://randomuser.me/api/portraits/lego/1.jpg'}" alt="${featuredReview.userName}">
                            <div class="reviewer-info">
                                <h5 class="mb-1">${featuredReview.userName}</h5>
                                <p class="mb-0">${featuredReview.userTitle || 'Customer'}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 text-center d-none d-lg-block">
                        <div style="font-size: 10rem; color: rgba(201, 160, 51, 0.2); line-height: 1;">"</div>
                    </div>
                </div>
            `;
            
            // Render regular reviews
            let html = '';
            regularReviews.forEach(review => {
                const stars = '&#9733;'.repeat(review.rating || 5);
                const emptyStars = '&#9734;'.repeat(5 - (review.rating || 5));
                
                html += `
                    <div class="col-lg-4 col-md-6">
                        <div class="em-review-card">
                            <div class="stars">${stars}${emptyStars}</div>
                            <h5 class="em-review-title">"${review.title}"</h5>
                            <p class="em-review-text">"${review.text}"</p>
                            <div class="reviewer">
                                <img src="${review.userPicture || 'https://randomuser.me/api/portraits/lego/1.jpg'}" alt="${review.userName}">
                                <div class="reviewer-info">
                                    <h6>${review.userName}</h6>
                                    <p>${review.userTitle || 'Customer'}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }

        function checkLoginStatus() {
            const user = typeof EMAuth !== 'undefined' ? EMAuth.getCurrentUser() : null;
            const reviewSection = document.getElementById('submit-review-section');
            const loginPrompt = document.getElementById('login-prompt-section');
            
            if (user && user.isLoggedIn && user.userType === 'user') {
                reviewSection.style.display = 'block';
                loginPrompt.style.display = 'none';
            } else {
                reviewSection.style.display = 'none';
                loginPrompt.style.display = 'block';
            }
        }

        function setupRatingStars() {
            const stars = document.querySelectorAll('.rating-stars .star');
            const ratingInput = document.getElementById('rating');
            
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.dataset.value);
                    ratingInput.value = value;
                    
                    stars.forEach((s, index) => {
                        if (index < value) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
                
                star.addEventListener('mouseover', function() {
                    const value = parseInt(this.dataset.value);
                    stars.forEach((s, index) => {
                        s.style.color = index < value ? '#c9a033' : '#ddd';
                    });
                });
                
                star.addEventListener('mouseout', function() {
                    const currentRating = parseInt(ratingInput.value);
                    stars.forEach((s, index) => {
                        s.style.color = index < currentRating ? '#c9a033' : '#ddd';
                    });
                });
            });
        }

        function submitReview(event) {
            event.preventDefault();
            
            const user = EMAuth.getCurrentUser();
            if (!user || !user.isLoggedIn) {
                if (typeof showNotificationModal === 'function') {
                    showNotificationModal('Please log in to submit a review.', 'warning', 'Login Required');
                }
                return;
            }
            
            const rating = parseInt(document.getElementById('rating').value);
            const title = document.getElementById('reviewTitle').value;
            const text = document.getElementById('reviewText').value;
            
            // Get user details
            const userData = EMAuth.getUserByGoogleId ? EMAuth.getUserByGoogleId(user.googleId) : null;
            
            EMAuth.addTestimonial({
                rating: rating,
                title: title,
                text: text,
                userName: user.name,
                userTitle: 'Customer',
                userPicture: user.picture || (userData ? userData.picture : null)
            });
            
            // Reset form
            document.getElementById('reviewForm').reset();
            document.getElementById('rating').value = 5;
            document.querySelectorAll('.rating-stars .star').forEach(s => s.classList.add('active'));
            
            // Show success message
            if (typeof showToast === 'function') {
                showToast('Thank you for your review! It will be visible once approved.', 'success');
            }
        }
    </script>
</body>
</html>
